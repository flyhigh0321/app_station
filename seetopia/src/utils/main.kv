#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import Factory kivy.factory.Factory

ScreenManager:
    MainWindow:
    SecondWindow:
    ThirdWindow:
<CustomInputField>:
    # id: dimension_text_field
    size_hint_x: .25
    mode: "fill"
    fill_color: 0, 0, 0, .05
    radius: [5,5,0,0] #ask pat
    pos_hint: {"center_x": .5, "center_y": .5}
    # color_mode: 'custom'
    # helper_text_mode: "on_error"
    line_color_focus: 0, 0, 0, 1
# <barcodePopup@Popup>:
<BarcodePopup>:
    id: barcode_popup
    auto_dismiss: True
    title: "Error"
    size_hint: 0.3, 0.2
    # pos_hint:{"x":0.2, "top":0.8}
    pos_hint:{"center_x":0.5, "center_y":0.5}
    separator_color: get_color_from_hex("#728F9B")
    GridLayout:
        cols: 1
        Label:
            id: error_msg
            size_hint: .9, .9
            halign: 'center'
            valign: 'middle'
            text: 'Unrecognised Barcode'
            text_size: self.width, None
            background:  get_color_from_hex("#FFFFFF")
        Button:
            text: 'Close'
            on_release: app.popup_dismiss()
    # Button:
    #     text: "Close"
    #     font_size: 14
    #     size_hint: 0.2, 0.2
    #     pos_hint:{"center_x":0.5, "center_y":0.5}
    #     on_release: app.popup_dismiss()

<TopToolBar@MDToolbar>:
    # title: "SKUtopia"
    # md_bg_color: rail.md_bg_color
    md_bg_color: get_color_from_hex("#728F9B")
    # left_action_items: [["menu", lambda x: app.rail_open()]]
    size_hint_y:  None
                     
<Logo@Image>:
    # id: skutopia_logo
    source: 'C:/Users/ElakkiyaRaj/0_PoetryProjects/skutopia_aiworkstation/seetopia/resources/img/SKUTOPIA_logo.png'
    size_hint_y: None
    height: 0.2 * self.texture_size[1]
    # pos_hint: { "center_y":0.5}
    padding: dp(25)  
     



<MainWindow>:
    name: "login"
    MDBoxLayout:
        orientation: "vertical"
        TopToolBar:
            title: "SKUtopia"
            height: "50dp" 
            left_action_items: [["menu", lambda x: app.rail_open()]]
        # MDToolbar:
        #     title: "SKUtopia"
        #     # md_bg_color: rail.md_bg_color
        #     md_bg_color: get_color_from_hex("#728F9B")
        #     left_action_items: [["menu", lambda x: app.rail_open()]]
        #     size_hint_y:  None
        #     height: "50dp"
        
        MDBoxLayout:
                       
            MDBoxLayout:
                Image:
                    id: vid
                    allow_stretch: True  
                    keep_ratio: True 
                    # pos_hint:{"center_x": 0.5, "center_y":0.5}
                    # pos_hint:{"x": 0}
                MDBoxLayout:
                    id: main_screen
                    orientation: 'vertical'
                    MDCard:
                        orientation: 'vertical'  
                        elevation: 20   
                        padding: "8dp"

                        MDCard:
                            pos_hint:{"center_x": 0.5, "center_y":0.5}
                            orientation: 'vertical'
                            Widget:
                                size_hint_y: 0.2
                            Logo:
                                id: skutopia_logo
                                # source: 'C:/Users/ElakkiyaRaj/0_PoetryProjects/skutopia_aiworkstation/seetopia/resources/img/SKUTOPIA_logo.png'
                                # size_hint_y: None
                                # height: 0.2 * self.texture_size[1]
                                # # pos_hint: { "center_y":0.5}
                                # padding: dp(25)
                                
                            Widget:
                                size_hint_y: 0.1
                            
                            MDTextField:
                                id: username
                                size_hint_x: .6
                                hint_text: "Enter your name"
                                mode: "fill"
                                fill_color: 0, 0, 0, .05
                                radius: [5,5,0,0] #ask pat
                                pos_hint: {"center_x": .5, "center_y": .5}
                                color_mode: 'custom'
                                # helper_text_mode: "on_error"
                                line_color_focus: 0, 0, 0, 1
                                # on_enter: app.user_authenticate()
                                # on_focus: app.user_text()
                                # required: True
                                

                            
                            Widget:
                                size_hint_y: 0.1
                                # height: "40dp"

                            MDFillRoundFlatButton:
                                text: "Submit"
                                font_size: 15
                                ripple_scale: .5
                                size_hint: (0.2,0.1)
                                pos_hint: {"center_x":0.5}
                                md_bg_color: get_color_from_hex("#728F9B")
                                hint_animation: True
                                # padding: dp(25)
                                on_press: app.user_authenticate()
                                on_release:
                                #     app.root.current = "second" if passw.text == "tim" else "main"
                                    root.manager.transition.direction = "left"   

                            Widget:
                                size_hint_y: 0.5
                            
                            
                                    

<SecondWindow>:
    name: "menu"
    MDBoxLayout:
        orientation: "vertical"
        TopToolBar:
            title: "SKUtopia"
            height: "50dp" 
            left_action_items: [["menu", lambda x: app.rail_open()]]
        
        MDBoxLayout:
            orientation: 'horizontal'
            MDNavigationRail:
                id: rail
                md_bg_color: get_color_from_hex("#F5F5F5")
                # color_normal: get_color_from_hex("#718089")
                color_active: get_color_from_hex("#f3ab44")
                use_resizeable: True  
                opacity: 0 
                MDNavigationRailItem:
                    icon: "texture-box"
                    text: "Area"
                    opacity: 0
                    
                MDNavigationRailItem:
                    icon: "filter"
                    text: "Filter"
                    opacity: 0

                MDNavigationRailItem:
                    icon: "selection-drag"
                    text: "Select"
                    opacity: 0
                Logo:
                    id: skutopia_logo
                    opacity: 0
                    
                Widget:
                    size_hint_y: 0.1

            MDBoxLayout:
                orientation: 'horizontal'
                MDBoxLayout:                    
                    Image:
                        id: vid
                        allow_stretch: True  
                        keep_ratio: True 
                        source: 'C:/Users/ElakkiyaRaj/0_PoetryProjects/skutopia_aiworkstation/seetopia/resources/img/SKUTOPIA_logo.png'
                    
                MDFloatLayout:
                    id: main_screen
                    
                    # pos_hint:{"center_x": 0.5}
                    md_bg_color: get_color_from_hex("#FFFFFF")
                        # MDToolbar:
                        #     md_bg_color: get_color_from_hex("#FFFFFF")
                        
                    MDLabel:
                        id: userWelcomeName
                        text: "Welcome"
                        theme_text_color: "Primary"
                        font_style: "H5"
                        pos_hint:{"center_x": 0.55, "center_y": 0.9}
                    MDFloatLayout:
                        id: search_layout
                        pos_hint:{"center_x": 0.5}
                        MDLabel:
                            text: "Find an item..."
                            halign: "left"
                            theme_text_color: "Primary"
                            bold: True
                            pos_hint:{"center_x": 0.62, "center_y": 0.82}
                        
                        MDIcon:
                            icon: "progress-question"
                            pos_hint:{"center_x": 0.55, "center_y": 0.82}
                            # pos_hint:{"center_x": 0.55}

                        MDLabel:
                            text: "Scan barcode or search below to start the QA."
                            halign: "left"
                            theme_text_color: "Secondary"
                            # valign: "top"
                            pos_hint:{"center_x": 0.55, "center_y": 0.77}
                            # pos_hint:{"center_x": 0.55}
                            text_size: self.width, None
                            # height: self.texture_size[1]
                        MDTextField:
                            id: search_field
                            # icon_right: 'magnify'
                            hint_text: 'Search icon'
                            size_hint_x: .9
                            hint_text: "Enter transfer ID"
                            color_mode: 'custom'
                            mode: "fill"
                            fill_color: 0, 0, 0, .05
                            radius: [5,5,0,0]
                            # helper_text_mode: "on_error"
                            line_color_focus: 0, 0, 0, 1
                            pos_hint:{"center_x": 0.50, "center_y": 0.67}
                            on_double_tap: app.search_clear_text()
                        MDIconButton:
                            icon: 'magnify'
                            theme_text_color: "Custom"
                            text_color: get_color_from_hex("#728F9B")
                            pos_hint:{"center_x": 0.9, "center_y": 0.67}
                            user_font_size: "40sp"
                            on_release: 
                                app.search_transfer() if root.ids.search_field.text  else "" 
                                root.manager.transition.direction = "left" 
                            # Button:
                            #     text: "Go Back"
                            #     on_release:
                            #         app.root.current = "login"
                            #         root.manager.transition.direction = "right"

<ThirdWindow>:
    name: "dashboard"
    MDBoxLayout:
        orientation: "vertical"
        TopToolBar:
            title: "SKUtopia"
            height: "50dp" 
            left_action_items: [["menu", lambda x: app.rail_open()]]
        
        MDBoxLayout:
            orientation: 'horizontal'
            MDNavigationRail:
                id: rail
                md_bg_color: get_color_from_hex("#F5F5F5")
                # color_normal: get_color_from_hex("#718089")
                color_active: get_color_from_hex("#f3ab44")
                use_resizeable: True 
                opacity: 0  
                MDNavigationRailItem:
                    icon: "texture-box"
                    text: "Area"
                    opacity: 0
                    
                MDNavigationRailItem:
                    icon: "filter"
                    text: "Filter"
                    opacity: 0

                MDNavigationRailItem:
                    icon: "selection-drag"
                    text: "Select"
                    opacity: 0
                Logo:
                    id: skutopia_logo
                    opacity: 0
                    
                Widget:
                    size_hint_y: 0.1

            MDBoxLayout:
                orientation: 'horizontal'
                MDBoxLayout:                    
                    Image:
                        id: vid
                        allow_stretch: True  
                        keep_ratio: True 
                        source: 'C:/Users/ElakkiyaRaj/0_PoetryProjects/skutopia_aiworkstation/seetopia/resources/img/SKUTOPIA_logo.png'
                    
                MDFloatLayout:
                    id: main_screen
                    
                    # pos_hint:{"center_x": 0.5}
                    md_bg_color: get_color_from_hex("#FFFFFF")
                        # MDToolbar:
                        #     md_bg_color: get_color_from_hex("#FFFFFF")
                    MDIconButton:
                        icon: "arrow-left-circle"
                        theme_text_color: "Custom"
                        text_color: get_color_from_hex("#728F9B")
                        pos_hint:{"center_x": 0.1, "center_y": 0.95}
                        user_font_size: "30sp"
                        on_release: 
                            app.root.current = "menu"
                            app.clear_states()
                            root.manager.transition.direction = "left" 
                    MDIconButton:
                        id: flag_transfer
                        icon: "flag-variant"
                        theme_text_color: "Custom"
                        text_color: get_color_from_hex("#808080")
                        pos_hint:{"center_x": 0.9, "center_y": 0.95}
                        user_font_size: "30sp"
                        on_press:
                            app.flag_transfer()
                            # root.manager.background_color : get_color_from_hex("#FF0000")
                            
                    MDLabel:
                        id: userWelcomeName
                        text: "Welcome"
                        theme_text_color: "Primary"
                        font_style: "H5"
                        pos_hint:{"center_x": 0.9, "center_y": 0.95}
                    MDFloatLayout:
                        id: dashboard_layout
                        pos_hint:{"center_x": 0.5}  
                        MDLabel:
                            id: scan_status
                            text: "Scanned"
                            halign: "left"
                            theme_text_color: "Primary"
                            theme_text_color: "Custom"
                            bold: True
                            pos_hint:{"center_x": 0.62, "center_y": 0.85}
                        MDIcon:
                            id: scan_status_icon
                            icon: "check-circle"
                            theme_text_color: "Custom"
                            text_color: get_color_from_hex("#808080")
                            pos_hint:{"center_x": 0.55, "center_y": 0.85}
                            # pos_hint:{"center_x": 0.55}      
                        MDLabel:
                            id: product_name
                            text: "Product Name : Sample "
                            halign: "left"
                            theme_text_color: "Secondary"
                            # valign: "top"
                            pos_hint:{"center_x": 0.62, "center_y": 0.80}
                            # pos_hint:{"center_x": 0.55}
                            text_size: self.width, None
                            theme_text_color: "Custom"
                            # height: self.texture_size[1]       

                        MDLabel:
                            id: product_sku
                            text: "Product SKU  : Sample "
                            halign: "left"
                            theme_text_color: "Secondary"
                            # valign: "top"
                            pos_hint:{"center_x": 0.62, "center_y": 0.75}
                            # pos_hint:{"center_x": 0.55}
                            text_size: self.width, None
                            theme_text_color: "Custom"
                            # height: self.texture_size[1] 
                        MDLabel:
                            id: measure_status
                            text: "Measured"
                            halign: "left"
                            theme_text_color: "Primary"
                            theme_text_color: "Custom"
                            text_color: get_color_from_hex("#808080")
                            bold: True
                            pos_hint:{"center_x": 0.62, "center_y": 0.70}
                        MDIcon:
                            id: measure_status_icon
                            icon: "progress-question"
                            theme_text_color: "Custom"
                            text_color: get_color_from_hex("#808080")
                            pos_hint:{"center_x": 0.55, "center_y": 0.70}
                            # pos_hint:{"center_x": 0.55}         

                        MDLabel:
                            id: item_length
                            text: "Length: "
                            halign: "left"
                            theme_text_color: "Secondary"
                            # valign: "top"
                            pos_hint:{"center_x": 0.62, "center_y": 0.65}
                            # pos_hint:{"center_x": 0.55}
                            text_size: self.width, None
                            theme_text_color: "Custom"
                            text_color: get_color_from_hex("#808080")
                            opacity: 1
                            # height: self.texture_size[1]       
                        MDLabel:
                            id: item_width
                            text: "Width: "
                            halign: "left"
                            theme_text_color: "Secondary"
                            # valign: "top"
                            pos_hint:{"center_x": 0.62, "center_y": 0.60}
                            # pos_hint:{"center_x": 0.55}
                            text_size: self.width, None
                            theme_text_color: "Custom"
                            text_color: get_color_from_hex("#808080")
                            opacity: 1
                            # height: self.texture_size[1] 
                          
                        MDLabel:
                            id: item_depth
                            text: "Height: "
                            halign: "left"
                            theme_text_color: "Secondary"
                            # valign: "top"
                            pos_hint:{"center_x": 0.62, "center_y": 0.55}
                            # pos_hint:{"center_x": 0.55}
                            text_size: self.width, None
                            theme_text_color: "Custom"
                            text_color: get_color_from_hex("#808080")
                            opacity: 1
                            # height: self.texture_size[1]  

                        StackLayout:
                            orientation: "lr-tb"
                            spacing:[15,15]
                            pos_hint:{"center_x": 0.62 , "center_y": 0.07}
                            CustomInputField:
                                id: length_text_field
                                size_hint_x: .25
                                hint_text: " Enter Length"
                                mode: "fill"
                                fill_color: 0, 0, 0, .05
                                radius: [5,5,0,0] #ask pat
                                pos_hint: {"center_x": .5, "center_y": .5}
                                color_mode: 'custom'
                                # helper_text_mode: "on_error"
                                line_color_focus: 0, 0, 0, 1
                                text_size: self.width, None
                                opacity: 0
                                
                                
                            CustomInputField:
                                id: Length
                                hint_text: " Enter length"
                                text_size: self.width, None
                                opacity: 0
                                
                                
                            CustomInputField:
                                id: Height
                                hint_text: " Enter height"
                                text_size: self.width, None
                                opacity: 0
                                
                                
